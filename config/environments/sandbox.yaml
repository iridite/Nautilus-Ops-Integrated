# OKX 测试网环境配置
# 用于连接 OKX 测试网进行模拟实盘交易

extends: "base.yaml"

# 回测配置（sandbox 环境不使用，但 schema 要求必须有）
backtest:
  start_date: "2022-01-01"
  end_date: "2026-01-01"

# 测试网特定配置
sandbox:
  venue: "OKX"
  is_testnet: true

  # 交易标的由 Universe 自动生成（无需手动配置）
  # instrument_ids: []  # 留空，从 Universe 自动生成

  # Universe 动态标的池配置
  universe:
    enabled: true                          # 是否启用 Universe 过滤
    auto_generate: true                    # 是否自动生成 Universe
    file: "data/universe/universe_15_W-MON.json"  # Universe 文件路径
    freq: "W-MON"                          # 更新周期 (ME/W-MON/2W-MON)
    top_n: 15                              # 选取前 N 个标的
    initial_period: null                   # 初始周期（null=使用当前时间）
    strict_mode: false                     # 严格模式：加载失败时报错

  # 允许本地缺失 instrument json（便于快速迭代）
  allow_missing_instruments: true

  # API 环境变量名称
  api_key_env: "OKX_API_KEY"
  api_secret_env: "OKX_API_SECRET"
  api_passphrase_env: "OKX_API_PASSPHRASE"

  # 执行引擎配置
  reconciliation: true
  reconciliation_lookback_mins: 1440
  filter_position_reports: true

  # 缓存配置
  flush_cache_on_start: false

# 交易配置（覆盖 base.yaml）
trading:
  venue: "OKX"
  instrument_type: "SWAP"
  initial_balance: 10000 # 测试网使用较大的虚拟资金
  currency: "USDT"

# 日志配置（测试网需要详细日志）
logging:
  level: "INFO"
  file_level: "DEBUG"
  components:
    TradingNode: "INFO"
    LiveExecEngine: "INFO"
    Strategy: "DEBUG"
  components_only: true

# 文件清理配置（测试网保留较长时间）
file_cleanup:
  enabled: true
  use_time_rotation: true
  keep_days: 14
  delete_days: 60
  max_files_per_dir: 100
  target_dirs:
    - "log"
    - "output"
