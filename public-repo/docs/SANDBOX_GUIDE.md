# Sandbox æ¨¡æ‹Ÿç›˜ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

Sandbox æ¨¡å¼ç”¨äºåœ¨ OKX æµ‹è¯•ç½‘ç¯å¢ƒä¸­æµ‹è¯•ç­–ç•¥,ä½¿ç”¨è™šæ‹Ÿèµ„é‡‘è¿›è¡ŒçœŸå®çš„è®¢å•æ‰§è¡Œå’Œå¸‚åœºæ•°æ®è®¢é˜…ã€‚

## å‰ç½®æ¡ä»¶

### 1. è·å– OKX æµ‹è¯•ç½‘ API å‡­è¯

1. è®¿é—® [OKX æµ‹è¯•ç½‘](https://www.okx.com/account/my-api)
2. åˆ›å»ºæµ‹è¯•ç½‘ API Key
3. è®°å½•ä»¥ä¸‹ä¿¡æ¯:
   - API Key
   - API Secret
   - API Passphrase

### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `test.env` æ–‡ä»¶ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰:

```bash
# OKX æµ‹è¯•ç½‘ API å‡­è¯
OKX_API_KEY=your_api_key_here
OKX_API_SECRET=your_api_secret_here
OKX_API_PASSPHRASE=your_passphrase_here
```

**é‡è¦**: `test.env` å·²åœ¨ `.gitignore` ä¸­,ä¸ä¼šè¢«æäº¤åˆ° Gitã€‚

## å¿«é€Ÿå¯åŠ¨

### ä½¿ç”¨ CLI å‘½ä»¤ï¼ˆæ¨èï¼‰

```bash
uv run main.py sandbox
```

CLI ä¼šè‡ªåŠ¨:
- åŠ è½½ sandbox ç¯å¢ƒé…ç½®
- åˆå§‹åŒ–èµ„é‡‘è´¹ç‡ç†”æ–­å™¨
- å¯åŠ¨äº¤æ˜“èŠ‚ç‚¹

### æŒ‡å®šç¯å¢ƒï¼ˆå¯é€‰ï¼‰

```bash
# ä½¿ç”¨ç‰¹å®šç¯å¢ƒé…ç½®
uv run main.py sandbox --env sandbox

# æˆ–ä½¿ç”¨å…¶ä»–ç¯å¢ƒ
uv run main.py sandbox --env test
```

é»˜è®¤æƒ…å†µä¸‹ï¼ŒCLI ä¼šä» `config/active.yaml` è¯»å–æ´»åŠ¨ç¯å¢ƒé…ç½®ã€‚

## é…ç½®è¯´æ˜

### ç¯å¢ƒé…ç½®: `config/environments/sandbox.yaml`

```yaml
sandbox:
  venue: "OKX"
  is_testnet: true

  # äº¤æ˜“æ ‡çš„åˆ—è¡¨
  instrument_ids:
    - "ETH-USDT-SWAP.OKX"
    - "SOL-USDT-SWAP.OKX"
    - "BNB-USDT-SWAP.OKX"
    - "DOGE-USDT-SWAP.OKX"
```

### ç­–ç•¥é…ç½®: `config/strategies/keltner_rs_breakout.yaml`

å…³é”®å‚æ•°:
- `funding_rate_warning_annual: 50.0` - ç°è´§å›é€€é˜ˆå€¼ï¼ˆ50% å¹´åŒ–ï¼‰
- `funding_rate_danger_annual: 100.0` - ç†”æ–­å™¨é˜ˆå€¼ï¼ˆ100% å¹´åŒ–ï¼‰
- `max_positions: 5` - æœ€å¤§æŒä»“æ•°é‡
- `base_risk_pct: 0.05` - åŸºç¡€é£é™©ç™¾åˆ†æ¯”ï¼ˆ5%ï¼‰

## èµ„é‡‘è´¹ç‡ç†”æ–­å™¨

ç­–ç•¥é›†æˆäº†èµ„é‡‘è´¹ç‡ç†”æ–­å™¨,åœ¨å…¥åœºå‰è‡ªåŠ¨æ£€æŸ¥èµ„é‡‘è´¹ç‡:

### å†³ç­–é€»è¾‘

1. **æ­£å¸¸æ‰§è¡Œ** (èµ„é‡‘è´¹ç‡ < 50% å¹´åŒ–)
   - ä½¿ç”¨æ°¸ç»­åˆçº¦æ­£å¸¸å¼€ä»“
   - æ—¥å¿—: `âœ… æ­£å¸¸æ‰§è¡Œ`

2. **ç°è´§æ›¿ä»£** (50% â‰¤ èµ„é‡‘è´¹ç‡ < 100% å¹´åŒ–)
   - è‡ªåŠ¨åˆ‡æ¢åˆ°ç°è´§æ ‡çš„
   - é¿å…é«˜é¢èµ„é‡‘è´¹ç‡æŸè€—
   - æ—¥å¿—: `ğŸ’± ç°è´§æ›¿ä»£`

3. **æ‹’ç»ä¿¡å·** (èµ„é‡‘è´¹ç‡ â‰¥ 100% å¹´åŒ–)
   - æ‹’ç»å¼€ä»“ä¿¡å·
   - é¿å…æç«¯æ‹¥æŒ¤äº¤æ˜“
   - æ—¥å¿—: `ğŸš« ç†”æ–­å™¨æ‹’ç»ä¿¡å·`

### ç›‘æ§ç»Ÿè®¡

ç†”æ–­å™¨ä¼šè®°å½•ç»Ÿè®¡ä¿¡æ¯:
- æ€»ä¿¡å·æ•°
- æ‹’ç»æ¬¡æ•°
- ç°è´§æ›¿ä»£æ¬¡æ•°
- æ­£å¸¸æ‰§è¡Œæ¬¡æ•°

## å¸¸è§é—®é¢˜

### 1. API è¿æ¥å¤±è´¥

**ç—‡çŠ¶**: `API å¥åº·æ£€æŸ¥å¤±è´¥`

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `test.env` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”é…ç½®æ­£ç¡®
- ç¡®è®¤ API Key æœ‰æ•ˆä¸”æœªè¿‡æœŸ
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç¡®è®¤ç³»ç»Ÿæ—¶é—´åŒæ­¥ï¼ˆæ—¶é—´å·® < 5 ç§’ï¼‰

### 2. Instrument æ–‡ä»¶ç¼ºå¤±

**ç—‡çŠ¶**: `Instrument file not found`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# è·å–æ ‡çš„ä¿¡æ¯
uv run python scripts/fetch_instrument.py
```

æˆ–åœ¨ `sandbox.yaml` ä¸­è®¾ç½®:
```yaml
allow_missing_instruments: true  # ä»…ç”¨äºæµ‹è¯•
```

### 3. ç†”æ–­å™¨åˆå§‹åŒ–å¤±è´¥

**ç—‡çŠ¶**: `èµ„é‡‘è´¹ç‡ç†”æ–­å™¨åˆå§‹åŒ–å¤±è´¥`

**åŸå› **: å›æµ‹æ¨¡å¼æˆ–æ— ç½‘ç»œç¯å¢ƒ

**è¯´æ˜**: è¿™æ˜¯æ­£å¸¸çš„,ç†”æ–­å™¨ä»…åœ¨ sandbox/live æ¨¡å¼ä¸‹å·¥ä½œã€‚å›æµ‹æ¨¡å¼ä¼šè‡ªåŠ¨é™çº§ã€‚

## åœæ­¢ Sandbox

æŒ‰ `Ctrl+C` åœæ­¢è¿è¡Œã€‚ç³»ç»Ÿä¼š:
1. åœæ­¢æ¥æ”¶æ–°ä¿¡å·
2. å¹³ä»“æ‰€æœ‰æŒä»“ï¼ˆå¯é€‰ï¼‰
3. æ–­å¼€äº¤æ˜“æ‰€è¿æ¥
4. ä¿å­˜æ—¥å¿—å’ŒçŠ¶æ€

## æ—¥å¿—ä½ç½®

```
log/sandbox/OKX_TESTNET_{timestamp}/
â”œâ”€â”€ runtime/           # è¿è¡Œæ—¶æ—¥å¿—
â””â”€â”€ ...
```

## ä¸‹ä¸€æ­¥

å®Œæˆ sandbox æµ‹è¯•å,å¯ä»¥:
1. åˆ†æäº¤æ˜“æ—¥å¿—å’Œç»Ÿè®¡æ•°æ®
2. è°ƒæ•´ç­–ç•¥å‚æ•°
3. å‡†å¤‡å®ç›˜éƒ¨ç½²ï¼ˆè°¨æ…ï¼ï¼‰

## å®‰å…¨æç¤º

âš ï¸ **é‡è¦**:
- Sandbox ä½¿ç”¨è™šæ‹Ÿèµ„é‡‘,ä¸ä¼šé€ æˆçœŸå®æŸå¤±
- åˆ‡å‹¿åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨æµ‹è¯•ç½‘ API
- å®ç›˜å‰åŠ¡å¿…å……åˆ†æµ‹è¯•
- å§‹ç»ˆè®¾ç½®åˆç†çš„é£é™©é™åˆ¶
